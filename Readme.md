# Личный проект «Что посмотреть»

* Студент: [Вячеслав Корзун](https://htmlacademy.ru/profile/id240581).
* Наставник: [Денис Дудин](https://htmlacademy.ru/profile/id112510).

# О проекте

* «Что посмотреть» — онлайн кинотеатр нового поколения. Смотрите новинки абсолютно бесплатно и в лучшем качестве. Оставляйте отзывы, ставьте оценки и выбирайте только лучшее из мира большого кино.

# Спецификация проекта

https://10.react.pages.academy/static/spec/wtw.yaml

# Внешний API получения информации о фильмах

1. [Omdb API](https://omdbapi.com/)
2. [HTML Academy API](http://guide.phpdemo.ru/api/documentation)

# Инструкция по развёртыванию для ОС Windows

1. Сохраните у себя файлы проекта  

2. Установите Docker Decktop и запустите его

3. Установите Laravel в папку для проекта с помощью команды:  
    php artisan sail:install

4. В папку для проекта скопируйте все файлы проекта

5. Примеры настройки файла .env имеются в файле .env.example

    Проверьте правильность имени базы данных, пользователя и пароля. 
    Также установите параметр QUEUE_CONNECTION в QUEUE_CONNECTION=database 

6. Обязательно внесите файл .env в .gitignore!

7. Запустите терминал с правами администратора и войдите в папку с проектом

8. Запустите Linux  с помощью команды wsl. Если WSL не установлена, то установите с с помощью команды: wsl --install

9. Запустите Sail командой: .\vendor\bin\sail up

10. Запустите миграции командой:
    ./vendor/bin/sail artisan migrate

11. Открываем Docker-desktop, видим, что все контейнеры проекта запустились работают нормально.

    Если не запустился контейнер mysql, остановите контейнеры и поменяйте в docker-compose.yml:

     ports:
            - '${FORWARD_DB_PORT:-3306}:3306'
    на какой-нибудь другой, например:
    ports:
            - '${FORWARD_DB_PORT:-3346}:3306'

12. заходим в PHP контейнер(sail-8.2/app), во вкладке terminal пишем 
    php artisan migrate
    после их выполнения можно проверить работу тестов:
    php artisan test

13. По желанию, Вы можете наполнить свою базу данных фиктивными данными с помощью команды:
    ./vendor/bin/sail artisan db:seed или php artisan db:seed

8. Встроенные тесты

    Внимание!
    Имеющиеся в проекте тесты сбрасывают базу данных!
    Поэтому, чтобы не повредить данные в рабочей базе проекта, проводите тесты с подключением к тестовой базе данных.

    Для этого Вам необходимо в корне проекта создать файл .env.testing

    Скопируйте в него содержимое из Вашего файла .env и поменяйте DB_DATABASE=data_base_name на какое-либо другое имя, например, data_base_name_test. Создайте БД с таким именем.

    Теперь Вы можете запускать тесты с помощью команды
    ./vendor/bin/sail artisan test

    При этом фейковыми данными, необходимыми для тестов, будет наполнятся БД data_base_name_test.
    Ваша рабочая БД будет незатронута!
